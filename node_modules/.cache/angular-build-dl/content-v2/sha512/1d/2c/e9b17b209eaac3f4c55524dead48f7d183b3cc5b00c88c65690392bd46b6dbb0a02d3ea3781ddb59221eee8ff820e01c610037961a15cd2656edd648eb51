{"version":3,"sources":["./wizdm/src/app/pages/admin/user-access/user-access.component.ts","./wizdm/src/app/pages/admin/user-access/user-access.component.html","./wizdm/src/app/pages/admin/user-access/user-access.module.ts"],"names":[],"mappings":";;;;;;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkE;AAChB;AACF;;;;;;;;;;;;ICU5C,4EAA0C;IAAA,uDAAkC;IAAA,4DAAY;;;IAA9C,0DAAkC;IAAlC,mKAAkC;;;IAC5E,4EAAuC;IAAA,uDAA+B;IAAA,4DAAY;;;IAA3C,0DAA+B;IAA/B,gKAA+B;;;;IAZ1E,yEAGyB;IAGvB,iFAAgB;IAEd,4EAAW;IAAA,uDAAkC;IAAA,4DAAY;IACzD,8EAAiF;IAAjE,+UAAmB;IAAnC,4DAAiF;IACjF,2EAAU;IAAA,uDAAsB;IAAA,4DAAW;IAC3C,iIAAwF;IACxF,iIAAkF;IAEpF,4DAAiB;IAGjB,0EAAuE;IAErE,6EAAuI;IAA5B,qUAA2B;IACpI,wDACF;IAAA,4DAAS;IAET,6EAAwI;IAA7B,yUAA4B;IACrI,wDACF;IAAA,4DAAS;IAET,6EAAwI;IAA9B,0UAA6B;IACrI,wDACF;IAAA,4DAAS;IAEX,4DAAM;IAER,4DAAM;;;;;IAzBS,0DAAkC;IAAlC,gIAAkC;IAC7B,0DAAmB;IAAnB,iFAAmB;IACzB,0DAAsB;IAAtB,kHAAsB;IACpB,0DAA4B;IAA5B,iHAA4B;IAC5B,0DAAyB;IAAzB,8GAAyB;IAON,0DAAgD;IAAhD,mLAAgD;IAC7E,0DACF;IADE,uMACF;IAE+B,0DAAgD;IAAhD,oLAAgD;IAC7E,0DACF;IADE,gNACF;IAE+B,0DAA+C;IAA/C,oLAA+C;IAC5E,0DACF;IADE,iNACF;;ADnBG,MAAM,mBAAmB;IAK9B,YAAqB,IAAiB,EAAU,MAAuB;QAAlD,SAAI,GAAJ,IAAI,CAAa;QAAU,WAAM,GAAN,MAAM,CAAiB;IAAI,CAAC;IAE5E,2DAA2D;IACnD,SAAS,CAAC,WAA6B;QAE7C,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAiC,OAAO,EAAE,WAAW,CAAC,CAAC;IAChF,CAAC;IAED,4BAA4B;IACpB,UAAU,CAAC,GAAW,EAAE,IAAgB;QAE9C,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAyB,SAAS,GAAG,EAAE,EAAE,IAAI,CAAC,CAAC;IACzE,CAAC;IAEO,cAAc,CAAC,KAAa;QAElC,OAAO,IAAI,CAAC,SAAS,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,CAAE,0DAAG,CAAE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAE,CAAC,CAAC;IACrE,CAAC;IAEM,UAAU,CAAC,KAAa;QAE7B,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,SAAS,CAAE,IAAI,CAAC,EAAE,CAClD,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,IAAI,CAAC,YAAY,CACxC,CAAC;IACJ,CAAC;IAEM,WAAW,CAAC,KAAa;QAE9B,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,IAAI,CACpC,gEAAS,CAAE,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE;YAC3C,YAAY,EAAE;gBACZ,KAAK,EAAE,IAAI;aACZ;SACF,CAAC,CAAC,CACJ,CAAC,SAAS,CAAE,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAE,CAAC;IAC5C,CAAC;IAEM,YAAY,CAAC,KAAa;QAE/B,OAAO,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,IAAI,CACpC,gEAAS,CAAE,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE;YAC3C,YAAY,EAAE,IAAI;SACnB,CAAC,CAAC,CACJ,CAAC,SAAS,CAAE,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAE,CAAC;IAC5C,CAAC;;sFAjDU,mBAAmB;mGAAnB,mBAAmB;QCVhC,iHAiCM;QAEN,oEAAG;QAAA,uDAAmB;;QAAA,4DAAI;;QAnCA,2FAAqB;QAmC5C,0DAAmB;QAAnB,4IAAmB;;;;;;;;;;;;;;ACpCtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+C;AACF;AACW;AACU;AACT;AACF;AACI;AACW;AACE;AACV;;;AAE9D,MAAM,MAAM,GAAsB,CAAC;QAEjC,IAAI,EAAE,EAAE;QACR,OAAO,EAAE,cAAc;QACvB,SAAS,EAAE,0EAAmB;KAC/B,CAAC,CAAC;AAgBI,MAAM,gBAAgB;;gGAAhB,gBAAgB;2JAAhB,gBAAgB,kBAZlB;YACP,4DAAY;YACZ,0DAAW;YACX,qEAAgB;YAChB,+EAAkB;YAClB,sEAAc;YACd,oEAAa;YACb,wEAAe;YACf,mFAAoB;YACpB,kEAAmB,CAAC,QAAQ,CAAC,MAAM,CAAC;SACrC;oIAEU,gBAAgB,mBAbX,0EAAmB,aAEjC,4DAAY;QACZ,0DAAW;QACX,qEAAgB;QAChB,+EAAkB;QAClB,sEAAc;QACd,oEAAa;QACb,wEAAe;QACf,mFAAoB","file":"user-access-user-access-module-es2015.js","sourcesContent":["import { UserRecord, UserUpdate, UserIdentifier } from '../admin-types';\nimport { FunctionsClient } from '@wizdm/connect/functions/client';\nimport { AuthService } from '@wizdm/connect/auth';\nimport { map, switchMap } from 'rxjs/operators';\nimport { Component } from '@angular/core';\nimport { Observable } from 'rxjs';\n\n@Component({\n  selector: 'wm-user-access',\n  templateUrl: './user-access.component.html',\n  styleUrls: ['./user-access.component.scss']\n})\nexport class UserAccessComponent {\n\n  public email: string;\n  public result: any;\n\n  constructor(readonly auth: AuthService, private client: FunctionsClient) { }\n\n  /** List users based on idntifiers (uid, email, phone... */\n  private listUsers(identifiers: UserIdentifier[]): Observable<UserRecord[]> {\n\n    return this.client.post<UserIdentifier[], UserRecord[]>('users', identifiers);\n  }\n\n  /** Updates a user record */\n  private updateUser(uid: string, data: UserUpdate): Observable<UserRecord> {\n\n    return this.client.patch<UserUpdate, UserRecord>(`users/${uid}`, data);\n  }\n\n  private getUserByEmail(email: string): Observable<UserRecord> {\n\n    return this.listUsers([{ email }]).pipe( map( users => users[0] ));\n  }\n\n  public viewAccess(email: string) {\n\n    return this.getUserByEmail(email).subscribe( user => \n      this.result = user && user.customClaims \n    );\n  }\n\n  public grantAccess(email: string) {\n\n    return this.getUserByEmail(email).pipe(\n      switchMap( user => this.updateUser(user.uid, { \n        customClaims: { \n          admin: true \n        }\n      }))\n    ).subscribe( user => this.result = user );\n  }\n\n  public revokeAccess(email: string) {\n\n    return this.getUserByEmail(email).pipe(\n      switchMap( user => this.updateUser(user.uid, { \n        customClaims: null \n      }))\n    ).subscribe( user => this.result = user );\n  }\n}\n","\n<!-- Localized content -->\n<div *wmContent=\"let msgs select 'admin-access'\" \n      fxLayout=\"row\" fxLayoutAlign=\"center start\" \n      fxLayout.lt-sm=\"column\" fxLayoutAlign.lt-sm=\"center center\" \n      fxLayoutGap=\"16px\">\n\n  <!-- Users email form field -->\n  <mat-form-field>\n\n    <mat-label>{{ msgs.email?.label || 'Email' }}</mat-label>\n    <input matInput [(ngModel)]=\"email\" name=\"email\" email required #input=\"ngModel\">\n    <mat-hint>{{ msgs.email?.hint }}</mat-hint>\n    <mat-error *ngIf=\"input.errors?.required\">{{ msgs.email?.errors?.required }}</mat-error>\n    <mat-error *ngIf=\"input.errors?.email\">{{ msgs.email?.errors?.email }}</mat-error>\n\n  </mat-form-field>\n\n  <!-- Actions -->\n  <div fxLayout=\"column\" fxLayoutAlign=\"center center\" fxLayoutGap=\"8px\">\n\n    <button mat-button fxFlex=\"33\" [color]=\"msgs.actions?.view?.color || 'primary'\" [disabled]=\"input.invalid\" (click)=\"viewAccess(email)\">\n      {{ msgs.actions?.view?.caption || 'View priviledges' }}\n    </button>\n\n    <button mat-button fxFlex=\"33\" [color]=\"msgs.actions?.grant?.color || 'accent'\" [disabled]=\"input.invalid\" (click)=\"grantAccess(email)\">\n      {{ msgs.actions?.grant?.caption || 'Grant admin priviledges' }}\n    </button>\n\n    <button mat-button fxFlex=\"33\" [color]=\"msgs.actions?.revoke?.color || 'warn'\" [disabled]=\"input.invalid\" (click)=\"revokeAccess(email)\">\n      {{ msgs.actions?.reoke?.caption || 'Revoke admin proviledges' }}\n    </button>\n\n  </div>\n\n</div> \n\n<p>{{ result | json }}</p>","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { FlexLayoutModule } from '@angular/flex-layout';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { ContentRouterModule, RoutesWithContent } from '@wizdm/content';\nimport { UserAccessComponent } from './user-access.component';\n\nconst routes: RoutesWithContent = [{\n\n  path: '',\n  content: 'admin-access',\n  component: UserAccessComponent\n}];\n\n@NgModule({\n  declarations: [ UserAccessComponent ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    FlexLayoutModule,\n    MatFormFieldModule,\n    MatInputModule,\n    MatIconModule,\n    MatButtonModule,\n    MatProgressBarModule,\n    ContentRouterModule.forChild(routes)\n  ]\n})\nexport class UserAccessModule { }\n"],"sourceRoot":"webpack:///"}